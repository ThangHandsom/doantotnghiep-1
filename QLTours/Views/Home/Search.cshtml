@model IEnumerable<Tour>
<style>
    .yellow-star {
        color: #f8ce0b; 
    }
    .travel-box {
        background-image: url("/images/ban.jpg");
    }

    .single-package-item img {
        width: 100%; 
        height: 200px; 
        object-fit: cover; 
        border-radius: 20px;
        margin-bottom: 15px;
    }

    .single-package-item {
        text-align: center; /* Căn giữa nội dung */
    }

    .pagination li {
        margin: 0 3px;
    }

        .pagination li a,
        .pagination li span {
            padding: 6px 12px;
            border-radius: 6px;
        }

    .pagination .active a {
        background-color: #007bff;
        color: white !important;
        border-color: #007bff;
    }

    .pagination .disabled span {
        color: #aaa;
    }

    .minimal-pagination {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 18px;
        margin: 20px 0;
        user-select: none;
    }

    .page-number {
        font-size: 22px;
        color: #1b2141;
        text-decoration: none;
        padding: 10px 16px;
        border-radius: 50%;
        caret-color: transparent !important;
        display: inline-flex;
        justify-content: center;
        align-items: center;
        transition: background-color 0.25s ease, color 0.25s ease;
    }

        .page-number:hover {
            background: #e8e8e8;
        }

        .page-number.active {
            background: #e8e8e8;
            font-weight: 600;
        }

    .page-arrow {
        font-size: 30px;
        color: black;
        text-decoration: none;
        padding: 5px 12px;
        caret-color: transparent !important;
        transition: transform 0.2s ease;
    }

        .page-arrow.disabled {
            opacity: 0.3;
            pointer-events: none;
        }

        .page-arrow:hover {
            transform: translateX(2px);
        }
</style>
<section class="travel-box">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="single-travel-boxes" style="margin-top: 150px !important;">
                    <div class="gallary-header text-center">
                        <h2>
                            Tìm kiếm chuyến đi bạn muốn
                        </h2>
                    </div>
                    <div id="desc-tabs" class="desc-tabs">
                        <ul class="nav nav-tabs" role="tablist">
                            <li role="presentation" class="active">
                                <a href="#" aria-controls="tours" role="tab" data-toggle="tab">
                                    <i class="fa fa-tree"></i>
                                    Những chuyến đi thú vị
                                </a>
                            </li>
                        </ul>

                        <!-- Tab panes -->
                        <div class="tab-content">
                            <div role="tabpanel" class="tab-pane active fade-in" id="tours">
                                <div class="tab-para">
                                    <form method="get" action="@Url.Action("Search", "Home")">
                                        <div class="row">

                                            <div class="col-lg-3 col-md-4 col-sm-12">
                                                <div class="single-tab-select-box">
                                                    <h2>Tìm địa điểm</h2>
                                                    <input class="form-control" type="text" id="tourName" name="tourName" style="height: 49px;font-size: 16px;">
                                                </div>
                                            </div>

                                            <div class="col-lg-2  col-sm-4">

                                                <div class="single-tab-select-box">
                                                    <h2>Ngày đi </h2>
                                                    <div class="travel-check-icon">
                                                        <input type="date" name="startDate" class="form-control" placeholder="Ngày bắt đầu">
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-lg-2 col-sm-4">
                                                <div class="single-tab-select-box">
                                                    <h2>Ngày về</h2>
                                                    <div class="travel-check-icon">
                                                        <input type="date" name="endDate" class="form-control" placeholder="Ngày kết thúc">
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-lg-2 col-sm-4">
                                                <div class="single-tab-select-box">
                                                    <h2>Danh Mục</h2>
                                                    <select id="categoryId" name="categoryId" class="form-control" style="height: 49px; font-size: 16px;">
                                                        <option value="">Tất cả</option>
                                                        @if (ViewBag.Categories != null)
                                                        {
                                                            foreach (var item in ViewBag.Categories)
                                                            {
                                                                <option value="@item.Value">@item.Text</option>
                                                            }
                                                        }
                                                        else
                                                        {
                                                            <option value="">Không có danh mục nào</option>
                                                        }
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-lg-3  col-sm-4">
                                                <div class="about-btn  pull-right">
                                                    <button class="about-view travel-btn">Tìm kiếm</button>
                                                </div>
                                            </div>

                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
        </div>
    </div>
</section>
<!--travel-box end-->
<!--packages start-->
<section id="pack" class="packages">
    <div class="container">
        <div class="gallary-header text-center">
            <h2>
                Danh Sách Tour
            </h2>
        </div><!--/.gallery-header-->
        <div class="packages-content">
            <div class="row">
                <!-- Loop through each tour and display information -->
                @foreach (var tour in Model)
                {
                    <div class="col-md-4 col-sm-6">
                        <div class="single-package-item" style="border-radius: 20px">
                            <img src="/images/@tour.Img" alt="Tour Image">
                            <div class="single-package-item-txt">
                                <h3>
                                    @tour.TourName <span class="pull-right">
                                        @String.Format("{0:N0}₫", tour.Price)
                                    </span>
                                </h3>
                                <!-- Tính toán số sao trung bình từ đánh giá -->
                                @{
                                    double averageRating = 0.0;
                                    if (tour.Reviews.Any())
                                    {
                                        averageRating = tour.Reviews.Average(r => (double?)r.Rating) ?? 0.0;
                                    }
                                    string starIcons = GetStarIcons(averageRating);
                                }
                                <p>@Html.Raw(starIcons)</p>
                                <p>Ngày bắt đầu : @Html.DisplayFor(modelItem => tour.StartDate)</p>
                                <p>Ngày kết thúc : @Html.DisplayFor(modelItem => tour.EndDate)</p>
                                <p><i class="fa-solid fa-hotel"></i>: @tour.TourDetails.FirstOrDefault()?.Hotel?.HotelName</p>
                                <p>Phương tiện: @tour.TourDetails.FirstOrDefault()?.Vehicle?.VehicleName</p>

                                <div class="packages-para">
                                    <p>
                                        <span>
                                            <i class="fa fa-angle-right"></i>Số lượng vé  @tour.Quantity
                                        </span>
                                    </p>
                                </div>
                                <div class="about-btn">
                                    <a asp-action="TourDetail" asp-route-id="@tour.TourId" class="about-view packages-btn">
                                        Đặt ngay
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</section>
<!--packages end-->





@functions {
    string GetStarIcons(double rating)
    {
        string starIcons = "";
        int numberOfFullStars = (int)rating;
        for (int i = 0; i < numberOfFullStars; i++)
        {
            starIcons += "<i class='fa fa-star yellow-star'></i>"; // Thêm class yellow-star vào đây
        }

        double remainder = rating - numberOfFullStars;
        if (remainder >= 0.5)
        {
            starIcons += "<i class='fa fa-star-half yellow-star'></i>"; // Thêm class yellow-star vào đây
        }

        return starIcons;
    }
}

